

[SOILWAT2]: https://github.com/DrylandEcology/SOILWAT2
[rSOILWAT2]: https://github.com/DrylandEcology/rSOILWAT2
[rSW2st]: https://github.com/DrylandEcology/rSW2st
[rSW2analysis]: https://github.com/DrylandEcology/rSW2analysis




# Understanding future big sagebrush regeneration potential
[![DOI](https://zenodo.org/badge/360982261.svg)](https://zenodo.org/badge/latestdoi/360982261)

Contact: Daniel R Schlaepfer [ORCiD](https://orcid.org/0000-0001-9973-2065)


This repository contains the code developed for the manuscript

Understanding the future of big sagebrush regeneration:
challenges of projecting complex ecological processes

by Daniel R Schlaepfer, John B Bradford, William K Lauenroth, and
Robert K Shriver



<br>

## Table of contents

1. [File structure](#structure)
2. [Data](#data)
3. [Overview](#overview)
4. [Dependencies](#dependencies)


<br>
<a name="structure"></a>

## File structure

The code assumes the following organization of directories and files:
  * `1_Simulation_Setup/`
    holds netCDF files that describe and/or define the underlying
    simulation experiment; see section [Data](#data)

  * `1_Additional_Setup/`
    holds additional files that describe and/or define the underlying
    simulation experiment, e.g., "SFSW2_project_variables_metadata.csv"
    describing the variables and their organization in netCDF files

  * `2_Simulation_Output/`
    holds netCDF files that contain the simulation experiment output
    used by the analysis; see section [Data](#data)

  * `3_Prepared_Data/`
    holds intermediate files generated by the analysis code

  * `4_Analysis_Results/`
    will hold the analysis results including figures and tables produced
    by executing the R scripts

  * `Code/`
    contains the R scripts to run the analysis


<br>
<a name="data"></a>

## Data

  Data are available as netCDFs from the USGS ScienceBase-Catalog at
  https://doi.org/10.5066/P9MB2QB8

  The content of the group "Simulation_Setup" (i.e., all files and sub-folders)
  should be copied to folder `1_Simulation_Setup/`.
  The remaining groups should be copied (without renaming) to folder
  `2_Simulation_Output/`.

  There is a separate netCDF file for each variable simulated with SOILWAT2
  under separate soil types (where appropriate) and forced by a
  separate climate forcing data set
  (i.e., historical observed meteorological data or
  future projections derived from one of 37 global circulation models
  under one of two representative concentration pathways).

<br>
<a name="overview"></a>

## Overview

  The files
  `SagebrushRegeneration_1_Functions.R` and
  `SagebrushRegeneration_2_DescribeExperimentAnalysis.R`

  contain specific functions used for the analysis and prepare data structures
  (read in from `1_Simulation_Setup/`) that define and organize the simulations.

  The analysis code is organized in several independent scripts
  that each produce a part of the overall results:

  * Objective 1: Geographic patterns of big sagebrush regeneration
    - `SagebrushRegeneration_3_Part1a_HistoricalPatterns.R`
      for Figure 1 "4_Analysis_Results/Output1_GeographicPatterns/HistoricalPatterns/Fig_Maps_GISSM_vs_Shriver2018_Current-SoilSiteSpecific_v4.pdf",
      Table 1, Appendix S1 Table S3, Appendix S2 Figure S1

    - `SagebrushRegeneration_3_Part1b_FuturePatterns.R`
      for Figure 3 "4_Analysis_Results/Output1_GeographicPatterns/FuturePatterns/Fig_Maps_GISSM_vs_Shriver2018_SoilSiteSpecific_median_hybrid-delta-3mod.d90yrs.RCP85_v4.pdf",
      Table 1, Appendix S1 Table S3, Appendix S2 Figure S2

  * Objective 2: Robustness of projections
    - `SagebrushRegeneration_3_Part2a_Uncertainty-Agreement.R`
      for Figure 4 "4_Analysis_Results/Output2_Uncertainty/Fig_Agreement_GISSM_vs_Shriver2018_SoilSiteSpecific_median_hybrid-delta-3mod.d90yrs.RCP85_90perc-agreement_v4.pdf",
      Table 1, Appendix S2 Figure S3

    - `SagebrushRegeneration_3_Part2b_Uncertainty-Sensitivity.R`
      for Figure 5 "4_Analysis_Results/Output2_Uncertainty/Fig_Sensitivity_ExperimentalFactors_resps_v4.pdf",
      Appendix S1 Table S4, Appendix S2 Figure S4

    - `SagebrushRegeneration_3_Part2d_Uncertainty-Extrapolations.R`
      for Appendix S1 Table S5, Appendix S2 Figure S5-S8,

  * Objective 3: Regeneration patterns in relation to climate and soils
    - `SagebrushRegeneration_3_Part3a_EnvRelationships_Shriver2018.R`
      for Appendix S2 Figure S9

    - `SagebrushRegeneration_3_Part3b_GeneralEnvRelationships.R`
      for Figure 6 "4_Analysis_Results/Output3_EnvRelationships/Current_GeneralEnvRelationships/Fig_VisReg_GeneralEnvRelationships_Current_nclusters2.pdf",
      Table 2, Appendix S1 Table S2, Appendix S1 Table S6

    - `SagebrushRegeneration_3_Part3c_SoilDifferenceRelationships.R`
      for Table 2, Appendix S2 Figure S10

    - `SagebrushRegeneration_3_Part3d_GeneralFutureDiffEnvRelationships.R`
      for Figure 7 "4_Analysis_Results/Output3_EnvRelationships/FutureDelta_GeneralEnvRelationships/Fig_VisReg_FutureDiffEnvRelationships_merged-ensemble_hybrid-delta-3mod.d90yrs.RCP85_v4.pdf",
      Table 2, Appendix S1 Table S7, Appendix S2 Figure S11-S13



<br>
<a name="dependencies"></a>

## Dependencies

The R code utilizes several R packages available from CRAN or github including
  * `raster`, `sp`, `sf`, and `ncdf4` packages

  * [rSW2st][] and [rSW2analysis][] for manipulation of
    [SOILWAT2][]/[rSOILWAT2][] simulations; they can be installed with
    ```{r}
    remotes::install_github("DrylandEcology/rSW2st")
    remotes::install_github("DrylandEcology/rSW2analysis")
    ```
